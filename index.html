<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>バス時刻表</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            background-color: #ffffff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            max-width: 90%;
            width: 700px;
            padding: 30px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }
        h1 {
            color: #2c5282;
            font-size: 2.25rem; /* 36px */
            font-weight: 700;
            margin-bottom: 20px;
        }
        .instruction-text {
            font-size: 0.9rem;
            color: #667eea; /* Indigo */
            margin-bottom: 20px;
            font-weight: 500;
        }
        .selector-group {
            margin-bottom: 25px;
            display: flex;
            flex-direction: column; /* Stack selectors vertically */
            gap: 15px;
            align-items: center;
        }
        .schedule-selector, .bus-stop-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            width: 100%;
            max-width: 400px;
        }
        .schedule-selector label, .bus-stop-selector label {
            display: flex;
            align-items: center;
            font-size: 1.1rem; /* 18px */
            font-weight: 600;
            color: #2d3748;
            cursor: pointer;
        }
        .schedule-selector input[type="radio"], .bus-stop-selector input[type="radio"] {
            margin-right: 8px;
            transform: scale(1.3); /* 大きめのラジオボタン */
            accent-color: #3182ce; /* ハイライトカラー */
        }
        .bus-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-height: 500px; /* Limit height for scrollability */
            overflow-y: auto; /* Enable vertical scrolling */
            padding-right: 10px; /* Space for scrollbar */
        }
        .hour-group {
            background-color: #e0f2f7; /* Lighter blue for hour groups */
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #a7d9ee;
            text-align: left;
            scroll-margin-top: 20px; /* Space from top when scrolled to */
        }
        .hour-title {
            font-size: 1.5rem; /* 24px */
            font-weight: 700;
            color: #1e3a8a; /* Dark blue */
            margin-bottom: 10px;
            border-bottom: 2px solid #a7d9ee;
            padding-bottom: 5px;
        }
        .bus-item {
            display: flex;
            flex-direction: column; /* Allow vertical stacking for arrival/destination */
            align-items: flex-start; /* Align content to start */
            padding: 12px 15px;
            background-color: #f7fafc;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease-in-out;
            margin-bottom: 8px; /* Space between bus items */
        }
        .bus-item.clickable { /* For items with click action (arrival time) */
            cursor: pointer;
        }
        .bus-item:last-child {
            margin-bottom: 0; /* No margin for the last item in a group */
        }
        .bus-item.upcoming {
            background-color: #ebf8ff; /* Light blue */
            border-color: #63b3ed; /* Stronger blue */
            box-shadow: 0 4px 10px rgba(0, 128, 255, 0.15);
            transform: translateY(-3px);
            font-weight: 600;
        }
        .bus-item.past {
            opacity: 0.6;
            background-color: #edf2f7;
        }
        .bus-info { /* Wrapper for route and time */
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }
        .bus-item-route {
            font-size: 1.125rem; /* 18px */
            font-weight: 700;
            color: #2d3748;
            width: 40%; /* Adjust width for better alignment */
            text-align: left;
        }
        .bus-item-time {
            font-size: 1.5rem; /* 24px */
            font-weight: 700;
            color: #3182ce;
            width: 60%; /* Adjust width for better alignment */
            text-align: right;
        }
        .arrival-time-display, .destination-display {
            font-size: 0.95rem;
            color: #4a5568;
            font-weight: 500;
            margin-top: 5px;
            padding-top: 5px;
            border-top: 1px dashed #cbd5e0;
            width: 100%;
            text-align: left; /* 行き先表示も右寄せに */
            box-sizing: border-box;
        }
        .arrival-time-display {
            height: 0; /* Initially hidden with height 0 */
            overflow: hidden;
            transition: all 0.3s ease-out; /* Smooth transition for height */
        }
        .arrival-time-display.visible {
            height: auto; /* Show content */
            padding-top: 10px;
            margin-top: 10px;
        }
        .arrival-time-display.hidden {
            padding-top: 0;
            margin-top: 0;
        }

        /* Scrollbar styles for better aesthetics */
        .bus-list::-webkit-scrollbar {
            width: 8px;
        }
        .bus-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .bus-list::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        .bus-list::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Responsive adjustments */
        @media (max-width: 640px) {
            .container {
                padding: 20px;
            }
            h1 {
                font-size: 1.75rem; /* 28px */
            }
            .instruction-text {
                font-size: 0.85rem;
            }
            .selector-group {
                gap: 10px;
            }
            .schedule-selector, .bus-stop-selector {
                flex-direction: column;
                gap: 10px;
            }
            .schedule-selector label, .bus-stop-selector label {
                font-size: 1rem;
            }
            .hour-title {
                font-size: 1.25rem; /* 20px */
            }
            .bus-item {
                padding: 10px 12px;
            }
            .bus-item-route, .bus-item-time {
                width: 100%;
                text-align: left;
                margin-bottom: 4px; /* Adjust margin for stacked elements */
            }
            .bus-item-time {
                font-size: 1.2rem; /* 20px */
            }
            .arrival-time-display, .destination-display {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>バス時刻表</h1>
        <div class="instruction-text">春日台6丁目発のバス項目をタップ（クリック）すると、終点・西神中央駅前への到着時刻が表示されます。</div>

        <div class="selector-group">
            <div class="schedule-selector">
                <label>
                    <input type="radio" name="scheduleType" value="weekday" id="weekdayRadio"> 平日
                </label>
                <label>
                    <input type="radio" name="scheduleType" value="holiday" id="holidayRadio"> 土日祝
                </label>
            </div>
            <div class="bus-stop-selector">
                <label>
                    <input type="radio" name="busStop" value="kasugadai6chome" id="kasugadai6chomeRadio"> 春日台6丁目発
                </label>
                <label>
                    <input type="radio" name="busStop" value="seishinchuoekimae" id="seishinChuoEkiMaeRadio"> 西神中央駅前発
                </label>
            </div>
        </div>

        <div id="bus-schedule" class="bus-list">
            <!-- Bus schedule will be inserted here by JavaScript -->
        </div>
    </div>

    <script>
        // バス時刻データ (系統番号と時刻) - 春日台6丁目発
        const weekdayKasugadaiBusData = [
            { route: '21', time: '5:54' }, { route: '22', time: '6:06' }, { route: '21', time: '6:23' },
            { route: '28', time: '6:34' }, { route: '28', time: '6:44' }, { route: '28', time: '6:54' },
            { route: '22', time: '7:02' }, { route: '21', time: '7:09' }, { route: '28', time: '7:17' },
            { route: '21', time: '7:21' }, { route: '22', time: '7:26' }, { route: '21', time: '7:33' },
            { route: '21', time: '7:45' }, { route: '28', time: '7:51' }, { route: '28', time: '7:59' },
            { route: '21', time: '8:05' }, { route: '28', time: '8:14' }, { route: '22', time: '8:19' },
            { route: '28', time: '8:29' }, { route: '22', time: '8:31' }, { route: '28', time: '8:44' },
            { route: '28', time: '9:00' }, { route: '22', time: '9:08' }, { route: '21', time: '9:23' },
            { route: '28', time: '9:40' }, { route: '22', time: '10:08' }, { route: '21', time: '10:23' },
            { route: '28', time: '10:40' }, { route: '22', time: '11:08' }, { route: '21', time: '11:23' },
            { route: '28', time: '11:40' }, { route: '22', time: '12:08' }, { route: '21', time: '12:23' },
            { route: '28', time: '12:40' }, { route: '21', time: '13:02' }, { route: '22', time: '13:08' },
            { route: '21', time: '13:23' }, { route: '28', time: '13:40' }, { route: '22', time: '14:08' },
            { route: '21', time: '14:23' }, { route: '28', time: '14:40' }, { route: '21', time: '14:53' },
            { route: '22', time: '15:08' }, { route: '21', time: '15:23' }, { route: '28', time: '15:40' },
            { route: '22', time: '15:48' }, { route: '28', time: '15:55' }, { route: '21', time: '16:02' },
            { route: '22', time: '16:07' }, { route: '28', time: '16:15' }, { route: '22', time: '16:22' },
            { route: '28', time: '16:30' }, { route: '22', time: '16:37' }, { route: '21', time: '16:42' },
            { route: '22', time: '16:52' }, { route: '28', time: '17:00' }, { route: '22', time: '17:07' },
            { route: '28', time: '17:15' }, { route: '22', time: '17:22' }, { route: '28', time: '17:30' },
            { route: '21', time: '17:37' }, { route: '28', time: '17:45' }, { route: '28', time: '18:00' },
            { route: '22', time: '18:10' }, { route: '21', time: '18:17' }, { route: '22', time: '18:40' },
            { route: '28', time: '18:57' }, { route: '21', time: '19:07' }, { route: '28', time: '19:17' },
            { route: '22', time: '19:43' }, { route: '28', time: '19:48' }, { route: '22', time: '20:01' },
            { route: '28', time: '20:13' }, { route: '21', time: '21:18' }, { route: '28', time: '21:54' }
        ];

        const holidayKasugadaiBusData = [
            { route: '21', time: '5:56' }, { route: '21', time: '6:15' }, { route: '28', time: '6:30' },
            { route: '28', time: '6:45' }, { route: '22', time: '7:08' }, { route: '21', time: '7:23' },
            { route: '22', time: '7:38' }, { route: '21', time: '7:48' }, { route: '22', time: '7:53' },
            { route: '22', time: '8:08' }, { route: '21', time: '8:14' }, { route: '22', time: '8:23' },
            { route: '22', time: '8:38' }, { route: '22', time: '8:53' }, { route: '22', time: '9:08' },
            { route: '21', time: '9:23' }, { route: '28', time: '9:40' }, { route: '22', time: '10:08' },
            { route: '21', time: '10:23' }, { route: '28', time: '10:40' }, { route: '22', time: '11:08' },
            { route: '21', time: '11:23' }, { route: '28', time: '11:40' }, { route: '22', time: '12:08' },
            { route: '21', time: '12:23' }, { route: '28', time: '12:40' }, { route: '21', time: '13:02' },
            { route: '22', time: '13:08' }, { route: '21', time: '13:23' }, { route: '28', time: '13:40' },
            { route: '22', time: '14:08' }, { route: '21', time: '14:23' }, { route: '28', time: '14:40' },
            { route: '22', time: '15:08' }, { route: '21', time: '15:23' }, { route: '28', time: '15:40' },
            { route: '21', time: '16:11' }, { route: '21', time: '16:41' }, { route: '22', time: '17:11' },
            { route: '22', time: '17:41' }, { route: '22', time: '18:11' }, { route: '22', time: '18:41' },
            { route: '22', time: '19:11' }, { route: '22', time: '19:41' }, { route: '28', time: '21:07' },
            { route: '22', time: '22:21' }
        ];

        // バス時刻データ (系統番号、時刻、行き先コード) - 西神中央駅前発
        const weekdaySeishinChuoBusData = [
            { route: '22', time: '6:12', destinationCode: 'a' },
            { route: '28', time: '6:32', destinationCode: 'b' },
            { route: '28', time: '6:42', destinationCode: 'b' },
            { route: '22', time: '6:44', destinationCode: 'a' },
            { route: '22', time: '7:04', destinationCode: 'a' },
            { route: '28', time: '7:11', destinationCode: 'a' },
            { route: '21', time: '7:23', destinationCode: 'a' },
            { route: '22', time: '7:27', destinationCode: 'a' },
            { route: '28', time: '7:38', destinationCode: 'a' },
            { route: '22', time: '7:43', destinationCode: 'a' },
            { route: '28', time: '7:50', destinationCode: 'a' },
            { route: '22', time: '7:55', destinationCode: 'a' },
            { route: '28', time: '8:05', destinationCode: 'a' },
            { route: '22', time: '8:07', destinationCode: 'a' },
            { route: '21', time: '8:20', destinationCode: 'a' },
            { route: '28', time: '8:33', destinationCode: 'a' },
            { route: '22', time: '8:35', destinationCode: 'a' },
            { route: '28', time: '8:45', destinationCode: 'a' },
            { route: '22', time: '8:46', destinationCode: 'a' },
            { route: '28', time: '9:00', destinationCode: 'a' },
            { route: '22', time: '9:10', destinationCode: 'b' },
            { route: '28', time: '9:20', destinationCode: 'b' },
            { route: '22', time: '9:30', destinationCode: 'a' },
            { route: '28', time: '9:40', destinationCode: 'b' },
            { route: '21', time: '9:45', destinationCode: 'a' },
            { route: '22', time: '9:50', destinationCode: 'b' },
            { route: '28', time: '10:00', destinationCode: 'a' },
            { route: '22', time: '10:10', destinationCode: 'b' },
            { route: '28', time: '10:20', destinationCode: 'b' },
            { route: '22', time: '10:30', destinationCode: 'a' },
            { route: '28', time: '10:40', destinationCode: 'b' },
            { route: '21', time: '10:45', destinationCode: 'a' },
            { route: '22', time: '10:50', destinationCode: 'b' },
            { route: '28', time: '11:00', destinationCode: 'a' },
            { route: '22', time: '11:10', destinationCode: 'b' },
            { route: '28', time: '11:20', destinationCode: 'b' },
            { route: '22', time: '11:30', destinationCode: 'a' },
            { route: '28', time: '11:40', destinationCode: 'b' },
            { route: '21', time: '11:45', destinationCode: 'a' },
            { route: '22', time: '11:50', destinationCode: 'b' },
            { route: '28', time: '12:00', destinationCode: 'a' },
            { route: '22', time: '12:10', destinationCode: 'b' },
            { route: '28', time: '12:20', destinationCode: 'b' },
            { route: '22', time: '12:30', destinationCode: 'a' },
            { route: '28', time: '12:40', destinationCode: 'b' },
            { route: '21', time: '12:45', destinationCode: 'a' },
            { route: '22', time: '12:50', destinationCode: 'b' },
            { route: '28', time: '13:00', destinationCode: 'a' },
            { route: '22', time: '13:10', destinationCode: 'b' },
            { route: '21', time: '13:20', destinationCode: 'a' },
            { route: '28', time: '13:20', destinationCode: 'b' },
            { route: '22', time: '13:30', destinationCode: 'a' },
            { route: '28', time: '13:40', destinationCode: 'b' },
            { route: '21', time: '13:45', destinationCode: 'a' },
            { route: '22', time: '13:50', destinationCode: 'b' },
            { route: '28', time: '14:00', destinationCode: 'a' },
            { route: '22', time: '14:10', destinationCode: 'b' },
            { route: '21', time: '14:20', destinationCode: 'a' },
            { route: '28', time: '14:20', destinationCode: 'b' },
            { route: '22', time: '14:30', destinationCode: 'a' },
            { route: '28', time: '14:40', destinationCode: 'b' },
            { route: '21', time: '14:45', destinationCode: 'a' },
            { route: '22', time: '14:50', destinationCode: 'b' },
            { route: '28', time: '15:00', destinationCode: 'a' },
            { route: '22', time: '15:10', destinationCode: 'b' },
            { route: '21', time: '15:20', destinationCode: 'a' },
            { route: '28', time: '15:20', destinationCode: 'b' },
            { route: '22', time: '15:30', destinationCode: 'a' },
            { route: '28', time: '15:40', destinationCode: 'a' },
            { route: '21', time: '15:45', destinationCode: 'a' },
            { route: '22', time: '15:50', destinationCode: 'a' },
            { route: '28', time: '16:00', destinationCode: 'b' },
            { route: '22', time: '16:05', destinationCode: 'a' },
            { route: '28', time: '16:15', destinationCode: 'a' },
            { route: '22', time: '16:20', destinationCode: 'a' },
            { route: '28', time: '16:30', destinationCode: 'a' },
            { route: '22', time: '16:35', destinationCode: 'b' },
            { route: '21', time: '16:40', destinationCode: 'a' },
            { route: '28', time: '16:45', destinationCode: 'a' },
            { route: '22', time: '16:50', destinationCode: 'c' },
            { route: '21', time: '16:55', destinationCode: 'a' },
            { route: '28', time: '17:00', destinationCode: 'a' },
            { route: '22', time: '17:05', destinationCode: 'a' },
            { route: '28', time: '17:15', destinationCode: 'a' },
            { route: '22', time: '17:20', destinationCode: 'a' },
            { route: '28', time: '17:30', destinationCode: 'b' },
            { route: '22', time: '17:35', destinationCode: 'a' },
            { route: '28', time: '17:45', destinationCode: 'b' },
            { route: '21', time: '17:50', destinationCode: 'a' },
            { route: '22', time: '17:52', destinationCode: 'a' },
            { route: '28', time: '18:00', destinationCode: 'a' },
            { route: '22', time: '18:02', destinationCode: 'b' },
            { route: '28', time: '18:12', destinationCode: 'b' },
            { route: '22', time: '18:14', destinationCode: 'a' },
            { route: '28', time: '18:24', destinationCode: 'd' },
            { route: '22', time: '18:24', destinationCode: 'b' },
            { route: '22', time: '18:34', destinationCode: 'a' },
            { route: '28', time: '18:36', destinationCode: 'd' },
            { route: '21', time: '18:40', destinationCode: 'a' },
            { route: '22', time: '18:44', destinationCode: 'a' },
            { route: '28', time: '18:48', destinationCode: 'b' },
            { route: '22', time: '18:54', destinationCode: 'a' },
            { route: '28', time: '19:00', destinationCode: 'b' },
            { route: '22', time: '19:05', destinationCode: 'a' },
            { route: '28', time: '19:12', destinationCode: 'b' },
            { route: '22', time: '19:20', destinationCode: 'a' },
            { route: '28', time: '19:24', destinationCode: 'd' },
            { route: '21', time: '19:28', destinationCode: 'a' },
            { route: '22', time: '19:38', destinationCode: 'c' },
            { route: '28', time: '19:38', destinationCode: 'a' },
            { route: '22', time: '19:51', destinationCode: 'c' },
            { route: '28', time: '19:51', destinationCode: 'a' },
            { route: '22', time: '20:03', destinationCode: 'c' },
            { route: '28', time: '20:07', destinationCode: 'b' },
            { route: '21', time: '20:20', destinationCode: 'a' },
            { route: '28', time: '20:20', destinationCode: 'd' },
            { route: '22', time: '20:22', destinationCode: 'b' },
            { route: '28', time: '20:33', destinationCode: 'b' },
            { route: '22', time: '20:38', destinationCode: 'a' },
            { route: '28', time: '20:47', destinationCode: 'b' },
            { route: '22', time: '20:55', destinationCode: 'a' },
            { route: '28', time: '21:03', destinationCode: 'd' },
            { route: '22', time: '21:13', destinationCode: 'b' },
            { route: '28', time: '21:25', destinationCode: 'b' },
            { route: '21', time: '21:33', destinationCode: 'a' },
            { route: '22', time: '21:35', destinationCode: 'c' },
            { route: '28', time: '21:46', destinationCode: 'b' },
            { route: '22', time: '21:59', destinationCode: 'a' },
            { route: '28', time: '22:05', destinationCode: 'b' },
            { route: '22', time: '22:16', destinationCode: 'a' },
            { route: '28', time: '22:23', destinationCode: 'a' },
            { route: '22', time: '22:36', destinationCode: 'b' },
            { route: '28', time: '22:45', destinationCode: 'b' },
            { route: '22', time: '22:50', destinationCode: 'a' },
            { route: '28', time: '22:58', destinationCode: 'a' },
            { route: '22', time: '23:05', destinationCode: 'c' },
            { route: '22', time: '23:21', destinationCode: 'c' },
            { route: '28', time: '23:21', destinationCode: 'd' }
        ];

        // バス時刻データ (系統番号、時刻、行き先コード) - 西神中央駅前発 土日祝
        const holidaySeishinChuoBusData = [
            { route: '28', time: '6:48', destinationCode: 'a' },
            { route: '28', time: '7:03', destinationCode: 'a' },
            { route: '28', time: '7:18', destinationCode: 'a' },
            { route: '22', time: '7:27', destinationCode: 'a' },
            { route: '21', time: '7:33', destinationCode: 'a' },
            { route: '28', time: '7:45', destinationCode: 'a' },
            { route: '22', time: '7:52', destinationCode: 'a' },
            { route: '28', time: '8:03', destinationCode: 'a' },
            { route: '28', time: '8:18', destinationCode: 'a' },
            { route: '22', time: '8:20', destinationCode: 'b' },
            { route: '21', time: '8:31', destinationCode: 'a' },
            { route: '22', time: '8:35', destinationCode: 'b' },
            { route: '28', time: '8:45', destinationCode: 'a' },
            { route: '22', time: '8:50', destinationCode: 'b' },
            { route: '28', time: '9:00', destinationCode: 'a' },
            { route: '22', time: '9:10', destinationCode: 'b' },
            { route: '28', time: '9:20', destinationCode: 'b' },
            { route: '22', time: '9:30', destinationCode: 'a' },
            { route: '28', time: '9:40', destinationCode: 'b' },
            { route: '21', time: '9:45', destinationCode: 'a' },
            { route: '22', time: '9:50', destinationCode: 'b' },
            { route: '28', time: '10:00', destinationCode: 'a' },
            { route: '22', time: '10:10', destinationCode: 'b' },
            { route: '28', time: '10:20', destinationCode: 'b' },
            { route: '22', time: '10:30', destinationCode: 'a' },
            { route: '28', time: '10:40', destinationCode: 'b' },
            { route: '21', time: '10:45', destinationCode: 'a' },
            { route: '22', time: '10:50', destinationCode: 'b' },
            { route: '28', time: '11:00', destinationCode: 'a' },
            { route: '22', time: '11:10', destinationCode: 'b' },
            { route: '28', time: '11:20', destinationCode: 'b' },
            { route: '22', time: '11:30', destinationCode: 'a' },
            { route: '28', time: '11:40', destinationCode: 'b' },
            { route: '21', time: '11:45', destinationCode: 'a' },
            { route: '22', time: '11:50', destinationCode: 'b' },
            { route: '28', time: '12:00', destinationCode: 'a' },
            { route: '22', time: '12:10', destinationCode: 'b' },
            { route: '21', time: '12:20', destinationCode: 'a' },
            { route: '28', time: '12:20', destinationCode: 'b' },
            { route: '22', time: '12:30', destinationCode: 'a' },
            { route: '28', time: '12:40', destinationCode: 'b' },
            { route: '21', time: '12:45', destinationCode: 'a' },
            { route: '22', time: '12:50', destinationCode: 'b' },
            { route: '28', time: '13:00', destinationCode: 'a' },
            { route: '22', time: '13:10', destinationCode: 'b' },
            { route: '28', time: '13:20', destinationCode: 'b' },
            { route: '22', time: '13:30', destinationCode: 'a' },
            { route: '28', time: '13:40', destinationCode: 'b' },
            { route: '21', time: '13:45', destinationCode: 'a' },
            { route: '22', time: '13:50', destinationCode: 'b' },
            { route: '28', time: '14:00', destinationCode: 'a' },
            { route: '22', time: '14:10', destinationCode: 'b' },
            { route: '21', time: '14:20', destinationCode: 'a' },
            { route: '28', time: '14:20', destinationCode: 'b' },
            { route: '22', time: '14:30', destinationCode: 'a' },
            { route: '28', time: '14:40', destinationCode: 'b' },
            { route: '21', time: '14:45', destinationCode: 'a' },
            { route: '22', time: '14:50', destinationCode: 'b' },
            { route: '28', time: '15:00', destinationCode: 'a' },
            { route: '22', time: '15:10', destinationCode: 'b' },
            { route: '21', time: '15:20', destinationCode: 'a' },
            { route: '28', time: '15:20', destinationCode: 'b' },
            { route: '22', time: '15:30', destinationCode: 'a' },
            { route: '28', time: '15:40', destinationCode: 'b' },
            { route: '22', time: '15:50', destinationCode: 'b' },
            { route: '21', time: '15:52', destinationCode: 'a' },
            { route: '28', time: '16:00', destinationCode: 'b' },
            { route: '22', time: '16:10', destinationCode: 'b' },
            { route: '21', time: '16:20', destinationCode: 'a' },
            { route: '28', time: '16:20', destinationCode: 'b' },
            { route: '22', time: '16:30', destinationCode: 'b' },
            { route: '28', time: '16:40', destinationCode: 'b' },
            { route: '22', time: '16:50', destinationCode: 'b' },
            { route: '21', time: '16:52', destinationCode: 'a' },
            { route: '28', time: '17:00', destinationCode: 'd' },
            { route: '22', time: '17:10', destinationCode: 'b' },
            { route: '28', time: '17:20', destinationCode: 'a' },
            { route: '22', time: '17:25', destinationCode: 'c' },
            { route: '22', time: '17:40', destinationCode: 'b' },
            { route: '28', time: '17:40', destinationCode: 'a' },
            { route: '21', time: '17:52', destinationCode: 'a' },
            { route: '22', time: '17:55', destinationCode: 'c' },
            { route: '28', time: '18:00', destinationCode: 'd' },
            { route: '22', time: '18:10', destinationCode: 'b' },
            { route: '28', time: '18:20', destinationCode: 'a' },
            { route: '22', time: '18:25', destinationCode: 'c' },
            { route: '22', time: '18:40', destinationCode: 'b' },
            { route: '28', time: '18:40', destinationCode: 'd' },
            { route: '21', time: '18:52', destinationCode: 'a' },
            { route: '22', time: '18:55', destinationCode: 'c' },
            { route: '28', time: '19:00', destinationCode: 'd' },
            { route: '22', time: '19:10', destinationCode: 'b' },
            { route: '28', time: '19:20', destinationCode: 'a' },
            { route: '22', time: '19:30', destinationCode: 'c' },
            { route: '28', time: '19:40', destinationCode: 'a' },
            { route: '22', time: '19:50', destinationCode: 'b' },
            { route: '28', time: '20:00', destinationCode: 'b' },
            { route: '22', time: '20:10', destinationCode: 'a' },
            { route: '28', time: '20:20', destinationCode: 'a' },
            { route: '22', time: '20:30', destinationCode: 'b' },
            { route: '28', time: '20:40', destinationCode: 'b' },
            { route: '21', time: '20:45', destinationCode: 'a' },
            { route: '22', time: '20:50', destinationCode: 'c' },
            { route: '28', time: '21:00', destinationCode: 'd' },
            { route: '22', time: '21:10', destinationCode: 'c' },
            { route: '28', time: '21:20', destinationCode: 'b' },
            { route: '21', time: '21:25', destinationCode: 'a' },
            { route: '22', time: '21:30', destinationCode: 'b' },
            { route: '28', time: '21:45', destinationCode: 'd' },
            { route: '22', time: '21:50', destinationCode: 'c' },
            { route: '28', time: '22:00', destinationCode: 'a' },
            { route: '22', time: '22:10', destinationCode: 'b' },
            { route: '28', time: '22:10', destinationCode: 'd' },
            { route: '22', time: '22:40', destinationCode: 'c' },
            { route: '28', time: '22:40', destinationCode: 'd' }
        ];

        let currentActiveSchedule = null; // 現在選択されている時刻表タイプ (weekday/holiday)
        let currentBusStopType = null; // 現在選択されているバス停タイプ (kasugadai6chome/seishinchuoekimae)

        /**
         * 行き先コードをテキストに変換する関数
         * @param {string} code - 行き先コード (a, b, c, d)
         * @returns {string} - 行き先の日本語テキスト
         */
        function getDestinationText(code) {
            switch (code) {
                case 'a': return '西体育館';
                case 'b': return '西神中央駅前';
                case 'c': return 'かすがプラザ止';
                case 'd': return '春日台4丁目止';
                default: return '';
            }
        }

        /**
         * 到着時刻を計算する関数
         * @param {string} departureTimeStr - 発車時刻 (例: "7:09")
         * @param {string} route - 系統番号 (例: "21")
         * @param {string} scheduleType - スケジュールタイプ ("weekday" または "holiday")
         * @returns {string} - 到着時刻 (HH:MM形式)
         */
        function calculateArrivalTime(departureTimeStr, route, scheduleType) {
            const [depHour, depMinute] = departureTimeStr.split(':').map(Number);
            let travelMinutes;

            if (scheduleType === 'weekday') {
                // 平日: 午前9時を境に所要時間が変わる
                if (depHour < 9) { // 午前9時（9:00）より前の発車
                    if (route === '21') travelMinutes = 13;
                    else if (route === '22') travelMinutes = 17;
                    else if (route === '28') travelMinutes = 16;
                } else { // 午前9時（9:00）以降の発車
                    if (route === '21') travelMinutes = 13;
                    else if (route === '22') travelMinutes = 14;
                    else if (route === '28') travelMinutes = 13;
                }
            } else { // 土日祝
                if (route === '21') travelMinutes = 12;
                else if (route === '22') travelMinutes = 14;
                else if (route === '28') travelMinutes = 13;
            }

            let arrivalTotalMinutes = (depHour * 60 + depMinute) + travelMinutes;

            let arrHour = Math.floor(arrivalTotalMinutes / 60);
            let arrMinute = arrivalTotalMinutes % 60;

            // 日付をまたぐ場合の時間を調整 (今回はバスの運行時間帯から24時を超えることは想定しないが、念のため)
            if (arrHour >= 24) arrHour -= 24;

            return `${arrHour.toString().padStart(2, '0')}:${arrMinute.toString().padStart(2, '0')}`;
        }

        /**
         * 現在選択されている時刻表データ（平日/土日祝、バス停別）を取得するヘルパー関数
         * @returns {Array<Object>} 選択されているバスデータ
         */
        function getSelectedBusData() {
            if (currentBusStopType === 'kasugadai6chome') {
                return currentActiveSchedule === 'weekday' ? weekdayKasugadaiBusData : holidayKasugadaiBusData;
            } else { // currentBusStopType === 'seishinchuoekimae'
                return currentActiveSchedule === 'weekday' ? weekdaySeishinChuoBusData : holidaySeishinChuoBusData;
            }
        }

        /**
         * 与えられた時刻データをもとに時刻表を生成・更新する関数
         * @param {Array<Object>} currentBusData - 表示するバスデータ
         * @param {string} busStopType - 現在表示しているバス停のタイプ ('kasugadai6chome' または 'seishinchuoekimae')
         */
        function generateTimetable(currentBusData, busStopType) {
            const now = new Date();
            const currentHour = now.getHours();
            const currentMinute = now.getMinutes();

            const scheduleContainer = document.getElementById('bus-schedule');
            scheduleContainer.innerHTML = ''; // 既存の内容をクリア

            const groupedBusData = {};
            currentBusData.forEach(bus => {
                const hour = parseInt(bus.time.split(':')[0]);
                if (!groupedBusData[hour]) {
                    groupedBusData[hour] = [];
                }
                groupedBusData[hour].push(bus);
            });

            let firstUpcomingBusElement = null;

            const sortedHours = Object.keys(groupedBusData).sort((a, b) => Number(a) - Number(b));

            sortedHours.forEach(hour => {
                const hourGroupDiv = document.createElement('div');
                hourGroupDiv.classList.add('hour-group');
                hourGroupDiv.id = `hour-group-${hour}`;

                const hourTitle = document.createElement('h2');
                hourTitle.classList.add('hour-title');
                hourTitle.textContent = `${hour}時`;
                hourGroupDiv.appendChild(hourTitle);

                groupedBusData[hour].forEach(bus => {
                    const [busHour, busMinute] = bus.time.split(':').map(Number);
                    const busTimeInMinutes = busHour * 60 + busMinute;
                    const currentTimeInMinutes = currentHour * 60 + currentMinute;

                    const busItem = document.createElement('div');
                    busItem.classList.add('bus-item');

                    if (busTimeInMinutes > currentTimeInMinutes && firstUpcomingBusElement === null) {
                        busItem.classList.add('upcoming');
                        firstUpcomingBusElement = busItem;
                    } else if (busTimeInMinutes <= currentTimeInMinutes) {
                        busItem.classList.add('past');
                    }

                    const busInfoDiv = document.createElement('div');
                    busInfoDiv.classList.add('bus-info');

                    const routeSpan = document.createElement('span');
                    routeSpan.classList.add('bus-item-route');
                    routeSpan.textContent = `${bus.route}系統`;

                    const timeSpan = document.createElement('span');
                    timeSpan.classList.add('bus-item-time');
                    timeSpan.textContent = bus.time;

                    busInfoDiv.appendChild(routeSpan);
                    busInfoDiv.appendChild(timeSpan);
                    busItem.appendChild(busInfoDiv);

                    // バス停の種類によって表示内容とクリックイベントを分岐
                    if (busStopType === 'kasugadai6chome') {
                        busItem.classList.add('clickable'); // クリック可能であることを示すスタイル

                        // 春日台6丁目発のバスには常に「西神中央駅前行」の行き先を追加
                        const destinationDisplay = document.createElement('div');
                        destinationDisplay.classList.add('destination-display');
                        destinationDisplay.textContent = '西神中央駅前行'; // 「行き先:」を削除
                        busItem.appendChild(destinationDisplay);

                        const arrivalTimeDisplay = document.createElement('div');
                        arrivalTimeDisplay.classList.add('arrival-time-display', 'hidden');
                        busItem.appendChild(arrivalTimeDisplay);

                        busItem.addEventListener('click', () => {
                            const arrivalTime = calculateArrivalTime(bus.time, bus.route, currentActiveSchedule);
                            arrivalTimeDisplay.textContent = `西神中央駅前 到着時刻: ${arrivalTime}`;
                            arrivalTimeDisplay.classList.toggle('visible');
                            arrivalTimeDisplay.classList.toggle('hidden');
                        });
                    } else if (busStopType === 'seishinchuoekimae') {
                        const destinationDisplay = document.createElement('div');
                        destinationDisplay.classList.add('destination-display');
                        destinationDisplay.textContent = getDestinationText(bus.destinationCode); // 「行き先:」を削除
                        busItem.appendChild(destinationDisplay);
                        // 西神中央駅前発のバス項目はクリックアクションがないため、カーソルはデフォルト
                        busItem.style.cursor = 'default';
                    }

                    hourGroupDiv.appendChild(busItem);
                });

                scheduleContainer.appendChild(hourGroupDiv);
            });

            // 最初の次のバスが見つかった場合、そこまでスクロール
            if (firstUpcomingBusElement) {
                setTimeout(() => {
                    firstUpcomingBusElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }, 100);
            } else if (currentBusData.length > 0) {
                // 次のバスがない場合（例：終バス後）
                const noUpcoming = document.createElement('div');
                noUpcoming.classList.add('bus-item', 'text-gray-600', 'justify-center');
                noUpcoming.textContent = '本日の運行は終了しました。';
                scheduleContainer.appendChild(noUpcoming);
            } else {
                 // バスデータが全くない場合
                const noData = document.createElement('div');
                noData.classList.add('bus-item', 'text-gray-600', 'justify-center');
                noData.textContent = '表示するバスデータがありません。';
                scheduleContainer.appendChild(noData);
            }
        }

        // 初期ロード時の処理
        window.onload = function() {
            // ラジオボタン要素を取得
            const weekdayRadio = document.getElementById('weekdayRadio');
            const holidayRadio = document.getElementById('holidayRadio');
            const kasugadai6chomeRadio = document.getElementById('kasugadai6chomeRadio');
            const seishinChuoEkiMaeRadio = document.getElementById('seishinChuoEkiMaeRadio');

            // 現在の曜日を判定し、デフォルトで表示する時刻表の種類を選択
            const today = new Date();
            const dayOfWeek = today.getDay(); // 0:日, 1:月, ..., 6:土

            if (dayOfWeek === 0 || dayOfWeek === 6) { // 日曜日または土曜日
                holidayRadio.checked = true;
                currentActiveSchedule = 'holiday';
            } else { // 平日
                weekdayRadio.checked = true;
                currentActiveSchedule = 'weekday';
            }

            // バス停のデフォルト選択（春日台6丁目をデフォルトとする）
            kasugadai6chomeRadio.checked = true;
            currentBusStopType = 'kasugadai6chome';

            // 初期時刻表の生成
            generateTimetable(getSelectedBusData(), currentBusStopType);

            // ラジオボタンの変更イベントリスナーを設定
            weekdayRadio.addEventListener('change', () => {
                if (weekdayRadio.checked) {
                    currentActiveSchedule = 'weekday';
                    generateTimetable(getSelectedBusData(), currentBusStopType);
                }
            });

            holidayRadio.addEventListener('change', () => {
                if (holidayRadio.checked) {
                    currentActiveSchedule = 'holiday';
                    generateTimetable(getSelectedBusData(), currentBusStopType);
                }
            });

            kasugadai6chomeRadio.addEventListener('change', () => {
                if (kasugadai6chomeRadio.checked) {
                    currentBusStopType = 'kasugadai6chome';
                    generateTimetable(getSelectedBusData(), currentBusStopType);
                }
            });

            seishinChuoEkiMaeRadio.addEventListener('change', () => {
                if (seishinChuoEkiMaeRadio.checked) {
                    currentBusStopType = 'seishinchuoekimae';
                    generateTimetable(getSelectedBusData(), currentBusStopType);
                }
            });

            // 1分ごとに時刻表を更新
            setInterval(() => {
                generateTimetable(getSelectedBusData(), currentBusStopType);
            }, 60 * 1000);
        };
    </script>
</body>
</html>
